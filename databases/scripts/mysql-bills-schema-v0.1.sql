SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

DROP SCHEMA IF EXISTS `billsdb` ;

CREATE SCHEMA IF NOT EXISTS `billsdb` DEFAULT CHARACTER SET utf8 ;
SHOW WARNINGS;

USE `billsdb` ;

CREATE TABLE IF NOT EXISTS BILLS (
    BILL_ID       VARCHAR(100),
	BILL_SEQUENCE VARCHAR(100),
    BILL_DATETIME DATE,
    CLIENT_DNI    VARCHAR(100),
    BILL_TOTAL    DECIMAL(10,2)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS BILL_DETAIL (
    DETAIL_ID    VARCHAR(100),
    BILL_ID      VARCHAR(100),
	PRODUCT_CODE VARCHAR(100),
    QUANTITY     BIGINT,
    DISCOUNT     BIGINT
) ENGINE = InnoDB;

ALTER TABLE BILLS ADD CONSTRAINT PK_IMG PRIMARY KEY (BILL_ID);
ALTER TABLE BILLS ADD INDEX(BILL_SEQUENCE);

ALTER TABLE BILL_DETAIL ADD CONSTRAINT PK_IMG PRIMARY KEY (DETAIL_ID);
ALTER TABLE BILL_DETAIL ADD INDEX(BILL_ID);

ALTER TABLE BILL_DETAIL ADD FOREIGN KEY (BILL_ID) REFERENCES BILLS(BILL_ID);

INSERT INTO BILLS VALUES ('b3981c7c-05f1-4a0e-afb4-ef739329314e', '45857270', DATE_FORMAT(NOW(), '%Y-%m-%d %h:%i:%s'), '52313217Q', 221764);
INSERT INTO BILLS VALUES ('b7ffc973-45ec-47a3-83f3-e6f9f65527e3', '26921633', DATE_FORMAT(NOW(), '%Y-%m-%d %h:%i:%s'), '36397282N', 433230);
INSERT INTO BILLS VALUES ('d05d58db-e622-4f89-b733-96d6823019a8', '63539583', DATE_FORMAT(NOW(), '%Y-%m-%d %h:%i:%s'), '94675998V', 571900);
INSERT INTO BILLS VALUES ('ce4f5e33-019a-445d-bdb6-fbc442d6da44', '42251138', DATE_FORMAT(NOW(), '%Y-%m-%d %h:%i:%s'), '03137015E', 171869);
INSERT INTO BILLS VALUES ('435dc71d-f51f-426b-9422-18ac8c2fcac6', '59981659', DATE_FORMAT(NOW(), '%Y-%m-%d %h:%i:%s'), '22227571A', 197593);

INSERT INTO BILL_DETAIL VALUES ('3f69e808-0569-4290-acd3-f4bb150201cc', 'b3981c7c-05f1-4a0e-afb4-ef739329314e', 'DN86ZC5XIV', 1, 10);
INSERT INTO BILL_DETAIL VALUES ('37f7a733-f8d8-47c5-82d1-f3a8da91033a', 'b3981c7c-05f1-4a0e-afb4-ef739329314e', '86ZC5XIV0R', 3, 5);

INSERT INTO BILL_DETAIL VALUES ('2bcd85dd-c450-4a6f-addc-6b1820bfbafd', 'b7ffc973-45ec-47a3-83f3-e6f9f65527e3', 'FOL8ES7NRX', 1, 20);
INSERT INTO BILL_DETAIL VALUES ('16f61fce-7e9e-4904-8d4d-be2167bc3cf2', 'b7ffc973-45ec-47a3-83f3-e6f9f65527e3', 'OXTE1BY1OS', 2, 10);

INSERT INTO BILL_DETAIL VALUES ('b7775404-27eb-4c27-80ea-570295a22b15', 'd05d58db-e622-4f89-b733-96d6823019a8', 'CEY3O84XA4', 3, 10);
INSERT INTO BILL_DETAIL VALUES ('ee4f6019-f857-488d-abf1-bda1a7d169db', 'd05d58db-e622-4f89-b733-96d6823019a8', 'B41SKZEWF9', 2, 19);
INSERT INTO BILL_DETAIL VALUES ('2a7e7b89-33d8-46da-a8de-661c4a106e43', 'd05d58db-e622-4f89-b733-96d6823019a8', '5FXZVPK68E', 4, 6);

INSERT INTO BILL_DETAIL VALUES ('26d61a0b-124d-4d57-8abd-8d0042c85b5e', 'ce4f5e33-019a-445d-bdb6-fbc442d6da44', '6SK4XDCGQL', 5, 12);
INSERT INTO BILL_DETAIL VALUES ('56417857-cbd6-4829-9890-b42f20f7b08d', 'ce4f5e33-019a-445d-bdb6-fbc442d6da44', 'BM5VZS9F8T', 4, 3);

INSERT INTO BILL_DETAIL VALUES ('2b42a3d5-b23f-42bb-b1fc-4655aef121b3', '435dc71d-f51f-426b-9422-18ac8c2fcac6', 'I7IPPG0LH5', 1, 10);
INSERT INTO BILL_DETAIL VALUES ('6458a947-02c1-4221-83e7-a544de15aa71', '435dc71d-f51f-426b-9422-18ac8c2fcac6', 'I03DMXT9R7', 3, 5);
INSERT INTO BILL_DETAIL VALUES ('a00cf598-1e56-47ee-8e34-b1228136c9f6', '435dc71d-f51f-426b-9422-18ac8c2fcac6', 'DZZU0HDWPV', 2, 6);
